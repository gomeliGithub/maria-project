<div class="d-flex flex-column" id="controls">
    <div class="p-3" id="images" [attr.getFullCompressedImagesDataResult]="getFullCompressedImagesDataResult">
        <div id="listContainer">
            <table *ngIf="fullCompressedImagesListCount !== 0; else noContentBlock" class="table table-borderless table-hover">
                <thead>
                    <tr>
                        <th scope="col">#</th>
                        <th scope="col">Оригинальное имя</th>
                        <th scope="col">Размер оригинального изображения</th>
                        <th scope="col">Тип события</th>
                        <th scope="col">Описание фото</th>
                        <th scope="col">Загружен</th>
                        <th scope="col">Отображён на главной</th>
                        <th scope="col">Отображён на галерее</th>
                    </tr>
                </thead>
                <tbody>
                    <tr *ngFor="let compressedImage of fullCompressedImagesList; let i = index">
                        <th scope="row">{{ i + 1 }}</th>
                        <td>{{ compressedImage.originalName }}</td>
                        <td>{{ compressedImage.originalSize }}</td>
                        <td [ngSwitch]="compressedImage.imageEventType">
                            <ng-template ngSwitchCase="wedding">{{ 'IMAGEEVENTTYPES.WEDDING' | translate }}</ng-template>
                            <ng-template ngSwitchCase="holiday">{{ 'IMAGEEVENTTYPES.HOLIDAY' | translate }}</ng-template>
                            <ng-template ngSwitchCase="birthday">{{ 'IMAGEEVENTTYPES.BIRTHDAY' | translate }}</ng-template>
                        </td>
                        <td>{{ compressedImage.imageDescription }}</td>
                        <td>{{ compressedImage.uploadDate | date:"d/M/yy, H:mm" }}</td>
                        <td class="fw-bold" [ngClass]="{ 
                            'text-success': compressedImage.displayedOnHomePage === 1, 
                            'text-danger': compressedImage.displayedOnHomePage === 0
                        }">
                            {{ compressedImage.displayedOnHomePage | boolean }}
                        </td>
                        <td class="fw-bold" [ngClass]="{ 
                            'text-success': compressedImage.displayedOnGalleryPage === 1, 
                            'text-danger': compressedImage.displayedOnGalleryPage === 0
                        }">
                            {{ compressedImage.displayedOnGalleryPage | boolean }}
                        </td>
                        <td>
                            <div class="dropdown">
                                <button class="btn btn-secondary dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false">
                                    Управление
                                </button>
                                <ul class="dropdown-menu border-0 bg-transparent">
                                    <li class="text-bg-secondary rounded">
                                        <button class="dropdown-item btn btn-sm" type="button" [attr.originalImageName]="compressedImage.originalName" (click)="changeImageFormActivate($event)">
                                            Изменить тип события или описание
                                        </button>
                                    </li>
                                    <li class="text-bg-danger rounded">
                                        <button class="dropdown-item btn btn-sm" type="button" [attr.originalImageName]="compressedImage.originalName" (click)="deleteImage($event)">
                                            Удалить
                                        </button>
                                    </li>
                                    <li *ngIf="compressedImage.displayedOnHomePage === 0" class="text-bg-warning rounded">
                                        <button class="dropdown-item btn btn-sm" type="button" [attr.originalImageName]="compressedImage.originalName" [attr.targetPage]="'home'" (click)="changeImageDisplayTarget($event)">
                                            На главную
                                        </button>
                                    </li>
                                    <li *ngIf="compressedImage.displayedOnGalleryPage === 0" class="text-bg-warning rounded">
                                        <button class="dropdown-item btn btn-sm" type="button" [attr.originalImageName]="compressedImage.originalName" [attr.targetPage]="'gallery'" (click)="changeImageDisplayTarget($event)">
                                            В галерею
                                        </button>
                                    </li>
                                    <li *ngIf="compressedImage.displayedOnHomePage === 1 || compressedImage.displayedOnGalleryPage === 1" class="text-bg-warning rounded">                            
                                        <button class="dropdown-item btn btn-sm" type="button" [attr.originalImageName]="compressedImage.originalName" [attr.targetPage]="'original'" (click)="changeImageDisplayTarget($event)">
                                            В архив
                                        </button>
                                    </li>
                                </ul>
                            </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <ng-template #noContentBlock>  
                <div class="noContentBlock text-center text-danger fs-4 p-4">
                    <span class="fw-bold">{{ 'ADMINPANEL.NOIMAGESMESSAGE' | translate }}</span>
                </div>
            </ng-template>
        </div>
        <div class="d-flex flex-row justify-content-center" id="changeImageDataContainer" [ngClass]="{ 'visually-hidden': changeImageDataFormHidden }" #changeImageDataContainer>
            <form [formGroup]="changeImageDataForm" novalidate (submit)="changeImageData()">
                <div class="form-group form-floating mb-3">
                    <select class="form-control form-select" id="inputChangeEventType" formControlName="newImageEventType">
                        <option value="wedding" selected>{{ 'IMAGEEVENTTYPES.WEDDING' | translate }}</option>
                        <option value="holiday">{{ 'IMAGEEVENTTYPES.HOLIDAY' | translate }}</option>
                        <option value="birthday">{{ 'IMAGEEVENTTYPES.BIRTHDAY' | translate }}</option>
                    </select>
                    <label for="inputChangeEventType" class="form-label">Тип события</label>
                </div>
                <div class="form-group form-floating mb-3">
                    <input type="text" class="form-control" id="inputChangeImageDescription" formControlName="newImageDescription">
                    <label for="inputChangeImageDescription" class="form-label">Индивидуальное описание фото</label>
                </div>
                <div class="form-group text-center">
                    <button class="btn btn-secondary" [disabled]="changeImageDataForm.invalid">
                        Изменить
                    </button>
                </div>
            </form>
        </div>
        <div class="d-flex align-items-center visually-hidden" [ngClass]="{ 'visually-hidden': spinnerHidden }">
            <strong class="text-info fs-4" role="status">{{ spinnerTitle }}</strong>
            <div class="spinner-border text-info ms-auto" aria-hidden="true"></div>
        </div>
        <div class="d-flex flex-row justify-content-center" id="uploadImageContainer">
            <form [formGroup]="uploadImageForm" class="p-3 w-50 border border-light border-3 rounded" novalidate (submit)="uploadImage()">
                <div class="form-group form-floating mb-3">
                    <select class="form-control form-select" id="inputEventType" formControlName="imageEventType">
                        <option value="wedding" selected>{{ 'IMAGEEVENTTYPES.WEDDING' | translate }}</option>
                        <option value="holiday">{{ 'IMAGEEVENTTYPES.HOLIDAY' | translate }}</option>
                        <option value="birthday">{{ 'IMAGEEVENTTYPES.BIRTHDAY' | translate }}</option>
                    </select>
                    <label for="inputEventType" class="form-label">Тип события</label>
                    <div class="alert alert-danger" *ngIf="uploadImageForm.controls['imageEventType'].invalid && uploadImageForm.controls['imageEventType'].touched">
                        Не выбран тип события
                    </div>
                </div>
                <div class="form-group mb-3">
                    <input type="file" class="form-control" id="inputImage" placeholder="Название события" (change)="fileChange($event)" formControlName="image">
                    <div class="alert alert-danger" *ngIf="uploadImageForm.controls['image'].invalid && uploadImageForm.controls['image'].touched">
                        Не выбрано изображение
                    </div>
                </div>
                <div class="form-group form-floating mb-3">
                    <input type="text" class="form-control" id="inputImageDescription" formControlName="imageDescription">
                    <label for="inputImageDescription" class="form-label">Индивидуальное описание фото</label>
                </div>
                <div class="form-group text-center">
                    <button class="btn btn-primary" [disabled]="uploadImageForm.invalid">
                        Загрузить новое изображение
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>
<ng-template #appModal></ng-template>